(async()=>{function ob(a,b=!1){a=b?-a:a;return`
vec3 o=vec3(-1,1,0);
outColor=vec4(normalize(vec3(float(${a})*(texture(t0,vPixelCoord+ps*o.xz).x-texture(t0,vPixelCoord+ps*o.yz).x),float(${a})*(texture(t0,vPixelCoord+ps*o.zx).x-texture(t0,vPixelCoord+ps*o.zy).x),ps.y*100.))*.5+.5,1);
`}function Xa(a){return()=>{let b=a+=1831565813;b=Math.imul(b^b>>>15,b|1);b^=b+Math.imul(b^b>>>7,b|61);return((b^b>>>14)>>>0)/4294967296}}function C(a,b,d){return a+(b-a)*d}function Da(a,b,d){return a<b?b:a>d?d:a}function Ya(a,b,d){a=Da((d-a)/(b-a),0,1);return a*a*(3-2*a)}function ea(a,b,...d){function e(f,m){f=c.createShader(f);c.shaderSource(f,m);c.compileShader(f);return f}a=e(c.VERTEX_SHADER,a);b=e(c.FRAGMENT_SHADER,b);const k=c.createProgram();c.attachShader(k,a);c.attachShader(k,b);c.linkProgram(k);
const h=new Map;d.forEach(f=>h.set(f,c.getUniformLocation(k,f)));return{m:k,u:h}}function oa(){null===Ea&&(Ea=ea("#version 300 es\nlayout(location=0)in vec4 G;out vec2 A;uniform mat4 q,t;void main(){A=G.xy+.5,gl_Position=q*t*G;}","#version 300 es\nprecision highp float;uniform sampler2D B;in vec2 A;void main(){if(texture(B,A).w<.5)discard;}","q","t","B"));return Ea}function Za(...a){const b=[],d=[],e=[];for(const k of a){const h=b.length/3;b.push(...k.l);e.push(...k.v);d.push(...k.F.map(f=>f+h))}return{l:new Float32Array(b),
F:new Uint32Array(d),v:new Float32Array(e)}}function D(a=1,b=1,d=1){a/=2;b/=2;d/=2;d=new Float32Array([-a,-b,-d,a,-b,-d,-a,b,-d,a,b,-d,a,-b,d,-a,-b,d,a,b,d,-a,b,d,a,-b,-d,-a,-b,-d,a,-b,d,-a,-b,d,-a,b,-d,a,b,-d,-a,b,d,a,b,d,-a,-b,-d,-a,b,-d,-a,-b,d,-a,b,d,a,b,-d,a,-b,-d,a,b,d,a,-b,d]);a=new Uint32Array([0,3,1,0,2,3,4,7,5,4,6,7,8,11,9,8,10,11,12,15,13,12,14,15,16,19,17,16,18,19,20,23,21,20,22,23]);b=new Float32Array([0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,
1,0,0,1,0,0,1,0,0,1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0]);return{l:d,F:a,v:b}}function pb(a=1,b=16,d=24){const e=[],k=[];for(var h=0;h<b;++h){var f=-Math.PI/2+Math.PI*h/(b-1),m=Math.sin(-f);f=Math.cos(-f);for(var n=0;n<d;++n){const p=2*Math.PI*n/(d-1);e.push(Math.cos(p)*f,m,Math.sin(p)*f)}}for(h=0;h<b;++h)for(m=h*d,f=m+d,n=0;n<d;++n)k.push(m+n,m+n+1,f+n+1,m+n,f+n+1,f+n);b=new Float32Array(e);return{l:b.map(p=>p*a),F:new Uint32Array(k),v:b}}function $a(a,b){const d=[],e=[],k=[];var h=
[];for(var f=0;f<a.length;f+=2)h.push(new ab(a[f],a[f+1]));for(const m of h)d.push(m.x,m.y,b/-2),d.push(m.x,m.y,b/2),k.push(0,0,-1),k.push(0,0,1);for(a=2;a<h.length;++a)f=a-1,e.push(0,2*f,2*a,1,2*a+1,2*f+1);a=h[h.length-1];for(const m of h)h=d.length/3,d.push(a.x,a.y,b/2,a.x,a.y,b/-2,m.x,m.y,b/2,m.x,m.y,b/-2),f=m.clone().sub(a).normalize(),a=f.x,f.x=-f.y,f.y=a,a=m,k.push(f.x,f.y,0),k.push(f.x,f.y,0),k.push(f.x,f.y,0),k.push(f.x,f.y,0),e.push(h,h+3,h+1,h,h+2,h+3);return{l:new Float32Array(d),F:new Uint32Array(e),
v:new Float32Array(k)}}function qb(a){const b={r:1,H:1,b:1,a:1,ha:.8,J:.3,C:(new q).i(.5)};var d=.2/a,e=.04/a,k=[];for(var h=0;24>h;++h){var f=2*Math.PI*h/24;k.push(.4*Math.sin(f),.4*Math.cos(f))}d=$a(k,d);e=$a([-.2,0,.1,.4,.3,.4,.2,.2,.2,0],e);d.l=d.l.map(p=>p*a);e.l=e.l.map(p=>p*a);k=[];for(h=0;8>h;++h){f=2*Math.PI*h/8;var m=Math.sin(f),n=Math.cos(f);f=(new fa).s(0,0,-1,f);m=(new q(m*(.4-.1),n*(.4-.1),0)).B(a);n=structuredClone(e);for(let p=0;p<n.l.length;p+=3){const r=(new q(...n.v.subarray(p,
p+3))).K(f),x=(new q(...n.l.subarray(p,p+3))).K(f).add(m);n.v.set(r,p);n.l.set(x,p)}k.push(n)}return new E(Za(d,...k),b)}function rb(a,b,d,e,k){const h={r:1,H:1,b:1,a:1,ha:.8,J:.3,C:(new q).i(1)};var f=[],m=[];for(var n=0;8>=n;++n){var p=2*Math.PI*n/8,r=Math.sin(p);p=Math.cos(p);f.push(.2*r,-1,.2*p,0,1,0);m.push(r,0,p,r,0,p)}n=[];for(r=0;8>r;++r)n.push(2*r+2,2*r+1,2*r);f={l:new Float32Array(f),F:new Uint32Array(n),v:new Float32Array(m)};m=[];for(n=0;n<a;++n)for(r=.2*(2*n+1-a),p=0;p<b;++p){const x=
.2*(2*p+1-b),u=structuredClone(f);for(let B=0;B<u.l.length;B+=3)u.l[B]+=r,u.l[B+2]+=x;m.push(u)}a=new E(Za(...m),h);a.A(0,d);a.A(1,e);a.A(2,k);return a}function sb(a,b,d){pa.width=a;pa.height=b;d();d=c.createTexture();c.bindTexture(c.TEXTURE_2D,d);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.REPEAT);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.REPEAT);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR_MIPMAP_LINEAR);W&&c.texParameterf(c.TEXTURE_2D,W.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(16,
c.getParameter(W.MAX_TEXTURE_MAX_ANISOTROPY_EXT)));c.texImage2D(c.TEXTURE_2D,0,c.RGBA,a,b,0,c.RGBA,c.UNSIGNED_BYTE,pa);c.generateMipmap(c.TEXTURE_2D);return d}async function bb(a,b,d){return await new Promise(e=>{const k=new Image;k.onload=()=>e(sb(a,b,()=>tb.drawImage(k,0,0,a,b)));k.src=d})}function X(a){const b=Number.parseInt(a.substring(0,2),16)/255,d=Number.parseInt(a.substring(2,4),16)/255;a=Number.parseInt(a.substring(4,6),16)/255;return{r:b,H:d,b:a,a:1}}function g(a,b,d,e,k,h,f,m,n,p,r){a=
new qa(new q(a,b,d),r);a.transform.position.h(e,k,h);a.transform.rotation.s(f,m,n,p);ra.push(a);a.g.A(0,Y.ea);a.g.A(1,Y.ia);a.g.A(2,Y.J);e={object:a,o:[]};y.push(e);return e}function S(a,b,d,e,k){a=new ub(a,k);a.transform.position.h(b,d,e);ra.push(a);a.g.A(0,Y.ea);a.g.A(1,Y.ia);a.g.A(2,Y.J);b={object:a,o:[]};y.push(b);return b}function I(a,b,d,e,k){var h=new qa(new q(a,a,.2),l);h.g.visible=!1;const f=qb(.68*a);h.add(f);h.transform.position.h(b,d,e);h.transform.rotation.s(0,1,0,k);a=new ha(h,()=>ia(1));
O.push(a);h={object:h,o:[()=>f.transform.rotation.s(0,0,1,-10*z)]};y.push(h);return h}function ja(a,b,d,e,k,h=2,f=0){var m=new qa(new q(.4*a,1.2,.4*b),l);m.g.visible=!1;a=rb(a,b,null,null,null);m.add(a);m.transform.position.h(d,e,k);d=new ha(m,()=>ia(2));O.push(d);m={object:m,o:[]};t(m,e-1.9,e-.1,h,f);y.push(m);return m}function Fa(a,b,d,e,k,h,f){const m=new qa(new q(a,b,d),f);m.transform.position.h(e,k,h);a=new ha(m,vb);O.push(a);a={object:m,o:[()=>m.transform.position.y=k+.3*(1-(.5*Math.sin(10*
z)+.5))**10]};y.push(a);return a}function J(a,b,d,e,k){a=new cb(new q(a,b,d),.8);a.G=2E3;const h=new wb(e);a.add(h);O.push(new ha(a,f=>{f.ma(!1);k()}));e={object:a,o:[()=>{h.transform.rotation.s(0,1,0,2*z);h.transform.position.y=.1*Math.sin(3*z)}]};y.push(e);return e}function P(a,b,d,e){var k={r:.5,H:.3,b:.3,a:1},h=new E(D(.3,6,.3),k);const f=new E(D(.3,6,.3),k);k=new E(D(7.7,.3,.3),k);h.transform.position.h(-4,0,0);f.transform.position.h(4,0,0);k.transform.position.y=2.85;a=new db(new q(a,b+3,d),
(new fa).s(0,1,0,e),new q(8,6,.01));a.G=2E3;b=new eb(D(8,5.85,.01));b.j=1;b.transform.position.y=-.15;a.add(b);a.add(h);a.add(f);a.add(k);O.push(new ha(a,xb));h={object:a,o:[]};y.push(h);return h}function fb(a){yb();a();y.forEach(b=>Q.add(b.object));y.forEach(b=>gb(b.object));ia(0)}function yb(){const a=b=>{Q.remove(b);b.aa()};y.map(b=>b.object).forEach(b=>b.oa(a));y=[];ra=[];O=[]}function t(a,b,d,e,k=0,h=1){a.o.push(()=>a.object.transform.position[h]=C(b,d,Ya(-.8,.8,Math.cos(k+z*e))))}function sa(a,
b,d,e,k=.8,h=0){const f=0===e?1:0,m=1===e?1:0,n=2===e?1:0;a.o.push(()=>a.object.transform.rotation.s(f,m,n,C(-b,b,Ya(-k,k,Math.cos(h+z*d)))))}function hb(){ka.i((F.width=window.innerWidth)/(F.height=window.innerHeight))}function ib(){w.transform.rotation.s(0,1,0,Ga);ka.transform.rotation.s(1,0,0,ta)}function vb(){v.y=.3}function Z(){G=5;ua=0;Ha="Speed boost";va.style.opacity="1"}function Ia(){G=5;ua=1;Ha="High jump";va.style.opacity="1"}function gb(a){a.oa(b=>b instanceof Ja&&b.i())}function zb(){var a=
z;y.forEach(h=>{h.o.forEach(f=>f(h.object));0<h.o.length&&gb(h.object)});wa.transform.position.y=.1*a-3;G=Math.max(G-K,0);var b=0<G&&0===ua;a=0<G&&1===ua;va.style.opacity=0<G?"1":"0";Ab.style.width=G/5*100+"%";Bb.textContent=Ha+" - "+G.toFixed(1);var d=C(Ka,b?.2:.08,.1);Ka=d;b=b?3:1;var e=b/8;b=(new q(La-Ma,0,-(Na-Oa))).ca().B(la?b:e).K(w.transform.rotation).B(K);v.add(b);b=v.y;v.y=0;e=v.length;const k=la?10:1;v.ca().B(Math.min(e*(1-K*k),d));v.y=Math.max(b+-.3*K,-.5);Pa&&la&&(la=!1,v.y=Math.max(v.y,
a?.3:.1));a=w.transform.position.clone();w.transform.position.add(v);d=!1;for(const h of ra)if(b=h.ba(w.transform.position,.4))w.transform.position.add(b),.1<b.clone().normalize().L(Cb)&&(v.y=Math.max(v.y,0),d=!0);la=d;v.D(w.transform.position).sub(a);O.forEach(h=>h.ra());w.transform.position.y-.4<wa.transform.position.y+.5&&ia(3)}function jb(a){requestAnimationFrame(jb);if(xa){a/=1E3;var b=a-kb;kb=a;for(ma=Math.min(ma+b,Db);ma>K;)z+=K,ma-=K,zb();Q.V.D(w.transform.position);xa&&Q.j(ka)}}async function ia(a){va.style.opacity=
"0";xa=!1;3===a?T.classList.add("lava"):T.classList.add("dead");aa.textContent=["You survive... for now","You were sliced by saw blades","You were impaled by spikes","You burned in lava"][a];aa.classList.add("visible");if(0===a)if(A.style.display="none",ya)for(aa.textContent="Welcome to the Deadly\u2122 Obstacle Course!\n\nAre you ready to die?\n\n\n(Click to begin)";!Qa;)await new Promise(requestAnimationFrame);else 4===ba?(aa.textContent="Congratulations! You've completed...",A.style.display="",
A.textContent="...the easy levels! Let's increase the difficulty a bit, shall we?\n\n\n(Click to continue)",await new Promise(b=>setTimeout(b,1500)),A.classList.add("visible"),await new Promise(b=>{const d=()=>{window.removeEventListener("click",d);b()};window.addEventListener("click",d)}),ya=!0):ba===za.length&&(aa.textContent="Congratulations! You've completed all the levels!\n\nIt wasn't so hard, was it?",A.style.display="",A.textContent="Thanks for playing!",await new Promise(b=>setTimeout(b,
2500)),A.classList.add("visible"),await new Promise(()=>{}));else a="Anyways;Try again;Sigh;Don't let this happen again;Pathetic;You can do better than this;I expected more from you;Again;Try harder".split(";"),A.textContent=a[Math.random()*a.length|0]+"...";ya?ya=!1:(await new Promise(b=>setTimeout(b,1300)),A.classList.add("visible"),await new Promise(b=>setTimeout(b,1300)));aa.classList.remove("visible");A.classList.remove("visible");T.classList.remove("dead");T.classList.remove("lava");T.classList.add("respawn");
await new Promise(b=>setTimeout(b,700));A.style.display="";xa=!0;ma=K+.001;z=-1.99;O.forEach(b=>b.ma(!0));Q.g.transform.position.D(L);w.transform.position.D(M);v.h(0,-.5,0);ta=0;Ga=N;G=Ka=0;ib();T.classList.remove("dead");T.classList.remove("respawn");A.classList.remove("visible")}async function xb(){++ba;ba<za.length?fb(za[ba]):ia(0)}const F=document.createElement("canvas");F.style.position="absolute";F.style.top="0px";F.style.left="0px";const c=F.getContext("webgl2"),W=c.getExtension("EXT_texture_filter_anisotropic"),
lb=(a,b=.2)=>`
vec4 edgeBlend(vec2 uv)
{
const vec2 fadeWidth = vec2(${b});
const vec2 scaling = 1.0 - fadeWidth;
vec2 offsetuv = uv * scaling;
vec2 blend = clamp((uv - scaling) / fadeWidth, 0.0, 1.0);
return
blend.y * blend.x * ${a}(fract(offsetuv + (fadeWidth * 2.0))) +
blend.y * (1.0 - blend.x) * ${a}(vec2(fract(offsetuv.x + fadeWidth.x), fract(offsetuv.y + (fadeWidth.y * 2.0)))) +
(1.0 - blend.y) * (1.0 - blend.x) * ${a}(fract(offsetuv + fadeWidth)) +
(1.0 - blend.y) * blend.x * ${a}(vec2(fract(offsetuv.x + (fadeWidth.x * 2.0)), fract(offsetuv.y + fadeWidth.y)));
}

`;document.title="The Deadly\u2122 Obstacle Course";await new Promise(requestAnimationFrame);class Ra extends Float32Array{constructor(a,b){super(a);this.set(b??[])}clone(){return this.g.set(this)}set(a,b){super.set(a,b);return this}D(a){return this.set(a)}h(...a){return this.set(a)}i(a){for(let b=0;b<super.length;++b)this[b]=a;return this}add(a){for(let b=0;b<super.length;++b)this[b]+=a[b];return this}sub(a){for(let b=0;b<super.length;++b)this[b]-=a[b];return this}wa(a){for(let b=0;b<super.length;++b)this[b]*=
a[b];return this}B(a){for(let b=0;b<super.length;++b)this[b]*=a;return this}L(a){return this.g.D(this).wa(a).ta}get I(){return this.L(this)}get length(){return Math.sqrt(this.I)}get ta(){let a=0;for(let b=0;b<super.length;++b)a+=this[b];return a}normalize(){return this.B(1/this.length)}ca(){const a=this.length;return 1E-9<a?this.B(1/a):this.i(0)}}class q extends Ra{constructor(a=0,b=0,d=0){super(3,[a,b,d])}get g(){return new q}get x(){return this[0]}set x(a){this[0]=a}get y(){return this[1]}set y(a){this[1]=
a}get z(){return this[2]}set z(a){this[2]=a}j(a,b){return this.h(a.y*b.z-a.z*b.y,a.z*b.x-a.x*b.z,a.x*b.y-a.y*b.x)}fa(a){return this.j(this,a)}K(a){this.set(Aa.pqm(...this,...a));return this}N(a){const b=this.x,d=this.y,e=this.z,k=a[3]*b+a[7]*d+a[11]*e+a[15];this.x=(a[0]*b+a[4]*d+a[8]*e+a[12])/k;this.y=(a[1]*b+a[5]*d+a[9]*e+a[13])/k;this.z=(a[2]*b+a[6]*d+a[10]*e+a[14])/k;return this}}class ab extends Ra{constructor(a=0,b=0){super(2,[a,b])}get g(){return new ab}get x(){return this[0]}set x(a){this[0]=
a}get y(){return this[1]}set y(a){this[1]=a}}class fa extends Ra{constructor(a=0,b=0,d=0,e=1){super(4,[a,b,d,e])}get g(){return new fa}s(a,b,d,e){e/=2;const k=Math.sin(e);return this.h(a*k,b*k,d*k,Math.cos(e))}R(){this[3]*=-1;return this}}class Eb extends Float32Array{constructor(a){super(9);this.set(a??[1,0,0,0,1,0,0,0,1])}set(a,b){super.set(a,b);return this}R(){this.set(Aa.m3i(...this));return this}}class U extends Float32Array{constructor(a){super(16);this.set(a??[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,
1])}clone(){return new U(this)}set(a,b){super.set(a,b);return this}sa(a){return this.set(a)}multiply(a){return this.i(this,a)}ka(a){return this.i(a,this)}i(a,b){this.set(Aa.m4m(...a,...b));return this}g(a,b,d){this.set(Aa.m4c(...a,...b,...d));return this}va(a,b,d,e){this.set([.2/(b-a),0,0,0,0,.2/(d-e),0,0,(b+a)/(b-a),(d+e)/(d-e),-200.1/199.9,-1,0,0,-40/199.9,0])}ua(a,b,d,e){const k=1/(b-a),h=1/(d-e),f=1/300;this.set([2*k,0,0,0,0,2*h,0,0,0,0,-2*f,0,-((b+a)*k),-((d+e)*h),-(0*f),1])}j(a,b,d){b=b.clone().sub(a).normalize();
d=b.clone().fa(d).normalize();const e=d.clone().fa(b);return this.set([d.x,e.x,-b.x,0,d.y,e.y,-b.y,0,d.z,e.z,-b.z,0,-a.L(d),-a.L(e),a.L(b),1])}na(){return new Eb([this[0],this[1],this[2],this[4],this[5],this[6],this[8],this[9],this[10]])}}const Aa=(await WebAssembly.instantiateStreaming(fetch("w.wasm"),{})).instance.exports;class Fb{constructor(){this.position=new q;this.rotation=new fa}matrix(){return(new U).g(this.position,this.rotation,new q(1,1,1))}U(){const a=this.rotation.clone().R();return(new U).g(this.position.clone().B(-1).K(a),
a,new q(1,1,1))}}let R=null,Ea=null;class Ba{constructor(){this.children=new Set;this.parent=null;this.transform=new Fb;this.visible=!0;this.G=0}add(a){this.children.add(a);a.parent=this}remove(a){this.children.delete(a);a.parent=null}oa(a){a(this);this.children.forEach(a)}S(){const a=this.transform.matrix();return this.parent?.S().clone().multiply(a)??a.clone()}da(){const a=this.transform.U();return this.parent?.da().clone().ka(a)??a.clone()}get Ca(){return this.transform.position.clone().N(this.S())}M(){}aa(){}}
class mb extends Ba{constructor(){super(...arguments);this.W=new U}i(a=1){const b=.1*Math.tan(.6981317008),d=2*b;a*=d;const e=a/-2;this.W.va(e,e+a,b,b-d)}g(a=4,b=4){a/=2;b/=2;this.W.ua(-a,a,b,-b)}}class Gb extends mb{constructor(a){super();this.O=new U;this.target=new q;this.X=Math.min(c.getParameter(c.MAX_TEXTURE_SIZE),2048);this.g(a,a);this.ga=c.createFramebuffer();this.P=c.createTexture();c.bindTexture(c.TEXTURE_2D,this.P);c.texImage2D(c.TEXTURE_2D,0,c.DEPTH24_STENCIL8,this.X,this.X,0,c.DEPTH_STENCIL,
c.UNSIGNED_INT_24_8,null);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_COMPARE_MODE,c.COMPARE_REF_TO_TEXTURE);c.bindFramebuffer(c.FRAMEBUFFER,this.ga);c.framebufferTexture2D(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.TEXTURE_2D,this.P,0);this.pa=oa().u.get("t")}xa(a){var b=this.transform.position.clone().sub(this.target).normalize();a=(new q(0,0,-35)).N(a.S());b=(new U).j(a.clone().add(b),
a,new q(0,1,0));this.O.sa(this.W).multiply(b);b=oa();c.useProgram(b.m);c.uniformMatrix4fv(b.u.get("q"),!1,this.O)}}class Hb extends Ba{constructor(){super();this.V=new q;c.enable(c.DEPTH_TEST);c.depthFunc(c.LEQUAL);c.enable(c.CULL_FACE);c.cullFace(c.BACK);this.g=new Gb(70);this.g.transform.position.h(0,1,1)}j(a){c.viewport(0,0,this.g.X,this.g.X);c.bindFramebuffer(c.FRAMEBUFFER,this.g.ga);c.clear(c.DEPTH_BUFFER_BIT);this.g.xa(a);this.i(this.g,1,this.g);c.bindFramebuffer(c.FRAMEBUFFER,null);c.viewport(0,
0,c.canvas.width,c.canvas.height);c.clearColor(0,0,0,1);c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT);this.i(a,0,this.g)}i(a,b,d){const e=a.da(),k=a.W.clone().multiply(e),h={Ba:e,Y:k,qa:a.Ca,V:this.V},f=(m,n)=>{if(m.visible){var p=n.clone().multiply(m.transform.matrix());m.M(b,h,p,d);[...m.children].sort((r,x)=>r.G-x.G).forEach(r=>f(r,p))}};f(this,this.S())}}class Ca extends Ba{constructor(a,b,d){super();this.i=c.createVertexArray();c.bindVertexArray(this.i);this.la=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,
this.la);c.bufferData(c.ARRAY_BUFFER,a.l,c.STATIC_DRAW);c.enableVertexAttribArray(b);c.vertexAttribPointer(b,3,c.FLOAT,!1,0,0);this.ja=c.createBuffer();c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,this.ja);c.bufferData(c.ELEMENT_ARRAY_BUFFER,a.F,c.STATIC_DRAW);a.v&&void 0!==d&&(b=c.createBuffer(),c.bindBuffer(c.ARRAY_BUFFER,b),c.bufferData(c.ARRAY_BUFFER,a.v,c.STATIC_DRAW),c.enableVertexAttribArray(d),c.vertexAttribPointer(d,3,c.FLOAT,!0,0,0));c.bindVertexArray(null);this.I=a.F.length}aa(){super.aa();c.deleteBuffer(this.la);
c.deleteBuffer(this.ja)}}let Sa=null;class Ib extends Ca{constructor(){super(D(),0);null===Sa&&(Sa=ea("#version 300 es\nlayout(location=0)in vec3 e;out vec3 x;uniform mat4 c;void main(){x=e,gl_Position=(mat3(c)*x).xyzz;}","#version 300 es\nprecision highp float;in vec3 x;out vec4 m;uniform vec3 f;const float u=.2;const vec3 s=vec3(1.,.2,0.),y=vec3(1,.9,.8);vec3 l(float as){return max(exp(-pow(as,.3))*y-.4,0.);}vec3 z(vec3 at){float au=distance(at,f)*2.,av=min(au,1.),aw=1.-smoothstep(.01,.011,av),as=max(at.y+.2,.001);as=u*mix(av,1.,as)/as;vec3 ax=l(au),k=as*s;k=max(mix(pow(k,1.-k),k/(2.*k+.5-k),clamp(f.y*2.,0.,1.)),0.)+aw+ax;k*=pow(1.-av,10.)*8.+1.;float ay=abs(f.y*.5-.5);return mix(k,vec3(0.),min(ay,1.));}void main(){m=vec4(z(normalize(x)),1);}",
"c","f"));const {m:a,u:b}=Sa;this.m=a;this.g=b;this.G=1E3}M(a,b,d,e){0===a&&(c.useProgram(this.m),c.bindVertexArray(this.i),c.uniformMatrix4fv(this.g.get("c"),!1,b.Y),c.uniform3fv(this.g.get("f"),e.transform.position.clone().normalize()),c.cullFace(c.FRONT),c.depthFunc(c.LEQUAL),c.drawElements(c.TRIANGLES,this.I,c.UNSIGNED_INT,0),c.cullFace(c.BACK),c.depthFunc(c.LESS),c.bindVertexArray(null))}}class Ja extends Ba{constructor(){super(...arguments);this.U=new U}i(){this.U=this.da()}}class db extends Ja{constructor(a,
b,d){super();this.transform.position.D(a);this.transform.rotation.D(b);this.i();this.j=d.clone().B(.5)}ba(a,b){a=a.clone().N(this.U);let d=Infinity;const e=new q;for(let k=0;6>k;++k){const h=k/2|0,f=2*(k&1)-1,m=this.j[h]-a[h]*f+b;if(0>=m)return null;m<d&&(d=m,e.i(0),e[h]=m*f)}return e.K(this.transform.rotation)}}class cb extends Ja{constructor(a,b){super();this.transform.position.D(a);this.i();this.j=b}ba(a,b){a=a.clone().sub(this.transform.position);const d=a.length;return d<this.j+b?a.ca().B(this.j+
b-d):null}}class E extends Ca{constructor(a,b){super(a,0,1);this.j=new Map;null===R&&(R=ea("#version 300 es\nlayout(location=0)in vec4 G;layout(location=1)in vec3 F;out vec3 O,N,M,L,K,J;out vec4 v;uniform mat4 t;uniform mat3 h;uniform mat4 E;uniform mat3 b;uniform mat4 C,i;void main(){O=(E*G).xyz,N=b*F,M=G.xyz,L=F,K=(t*G).xyz,J=h*F,gl_Position=C*G,v=i*t*G*.5+.5;}","#version 300 es\nprecision highp float;precision highp sampler2DShadow;uniform sampler2D p,d,w;uniform sampler2DShadow a;uniform mat3 h,b;uniform bool D,g,P;uniform vec4 S;uniform float Z,Y,X,W;uniform vec3 V,U,T,R,Q;in vec3 O,N,M,L,K,J;in vec4 v;out vec4 m;vec3 I(vec3 az){vec3 aA=pow(abs(az),vec3(W));float aB=dot(aA,vec3(1));return aA/vec3(aB);}vec4 I(sampler2D B,vec3 aC,vec3 az){vec3 aD=I(az);vec4 aE=texture(B,aC.yz),aF=texture(B,aC.zx),aG=texture(B,aC.xy);return aE*aD.x+aF*aD.y+aG*aD.z;}vec3 l(sampler2D B,vec3 aC,vec3 az){vec3 aD=I(az);vec2 aH=aC.zy,aI=aC.xz,aJ=aC.xy;vec3 aK=texture(B,aH).xyz*2.-1.,aL=texture(B,aI).xyz*2.-1.,aM=texture(B,aJ).xyz*2.-1.,aN=vec3(0.,aK.yx),aO=vec3(aL.x,0.,aL.y),aP=vec3(aM.xy,0.);return normalize(aN*aD.x+aO*aD.y+aP*aD.z+az);}const float H=acos(-1.);float I(vec3 aQ,vec3 aR){return max(dot(aQ,aR),0.);}vec3 l(vec3 k,float aS){return k+(1.-k)*pow(1.-aS,5.);}vec3 I(vec3 aT,vec3 aU,vec3 aV,vec3 aW,vec3 aX,vec3 aY,vec3 aZ,float ba){float bb=I(aT,aV);vec3 bc=normalize(aV+aU),bd=l(aZ,dot(aV,bc));float be=pow(I(aT,bc),ba)*(ba+2.)/8.;vec3 bf=bd*be,bg=aY;float ap=0.;vec3 aq=v.xyz/v.w;vec2 ar=abs(vec2(.5)-aq.xy);if(aq.z>1.||ar.x>.5||ar.y>.5)ap=1.;else{float bh=max(.001*(1.-dot(normalize(J),R)),1e-4);aq.z-=bh/v.w;ap=texture(a,aq);}float as=distance(K.xz,Q.xz),bi=1.-smoothstep(.45,.5,as);bi*=smoothstep(0.,.4,Q.y-K.y);ap*=1.-bi;vec3 bj=ap*(bg+bf)*bb*aW;bj+=aY*aX;return bj;}vec3 z(vec3 aT,vec3 aU){vec3 bk=M,bl=normalize(L);aT=g?normalize(b*l(d,bk*V+U,bl)):aT;vec3 bm=D?I(p,bk*V+U,bl).xyz*S.xyz:S.xyz;float bn=P?I(w,bk*V+U,bl).x:Z;const vec3 bo=vec3(.04,.04,.04),bp=vec3(0.,0.,0.);vec3 aY=mix(bm*(1.-bo.x),bp,Y)/H,aZ=mix(bo,bm,Y);bn=1.2-.2/clamp(bn,1e-5,.99999);float ba=log(2.-bn)*185.;vec3 bj=vec3(0.,0.,0.),aV=T,bq=vec3(1.,.8,.5),br=vec3(1.,.9,.7)*1.5*(1.-I(J,-R)*.1);bj+=I(aT,aU,aV,bq,br,aY,aZ,ba);return bj;}void main(){vec3 aT=normalize(N),aU=normalize(-O),bs=z(aT,aU);m=vec4(bs,S.w);}",
"E","b","C","t","h","i","p","d","w","a","D","g","P","S","Y","Z","X","W","V","U","T","R","Q"),c.useProgram(R.m),c.uniform1i(R.u.get("p"),0),c.uniform1i(R.u.get("d"),1),c.uniform1i(R.u.get("w"),2),c.uniform1i(R.u.get("a"),3));const {m:d,u:e}=R;this.m=d;this.g=e;c.useProgram(d);this.za={...b};this.T=oa().m}Aa(){c.uniform1i(this.g.get("p"),0);c.uniform1i(this.g.get("d"),1);c.uniform1i(this.g.get("w"),2);c.uniform1i(this.g.get("D"),0);c.uniform1i(this.g.get("g"),0);c.uniform1i(this.g.get("P"),0);c.uniform1f(this.g.get("W"),
1);c.uniform3f(this.g.get("V"),1,1,1);c.uniform3f(this.g.get("U"),0,0,0);c.uniform1f(this.g.get("X"),.5);for(var a=0;8>a;++a)c.activeTexture(c.TEXTURE0+a),c.bindTexture(c.TEXTURE_2D,null);if(a=this.za){c.uniform4f(this.g.get("S"),a.r,a.H,a.b,a.a);c.uniform1f(this.g.get("Y"),a.ha??0);const b=1.2-.2/Da(a.J??.5,1E-5,.99999);c.uniform1f(this.g.get("Z"),b);c.uniform1f(this.g.get("W"),a.Da??1);a.C&&c.uniform3fv(this.g.get("V"),a.C);a.ya&&c.uniform3fv(this.g.get("U"),a.ya);for(const d of this.j){const [e,
k]=d;c.activeTexture(c.TEXTURE0+e);c.bindTexture(c.TEXTURE_2D,k);c.uniform1i(this.g.get(["D","g","P"][e]),k?1:0)}}}A(a,b){b?this.j.set(a,b):this.j.delete(a)}M(a,b,d,e){var k=b.Ba,h=b.Y;c.useProgram(0===a?this.m:this.T);c.bindVertexArray(this.i);if(0===a){a=k.clone().multiply(d);h=h.clone().multiply(d);const f=a.na().R(),m=d.na().R();c.uniformMatrix4fv(this.g.get("E"),!1,a);c.uniformMatrix4fv(this.g.get("C"),!1,h);c.uniformMatrix3fv(this.g.get("b"),!0,f);c.uniformMatrix4fv(this.g.get("t"),!1,d);c.uniformMatrix3fv(this.g.get("h"),
!0,m);c.uniform3fv(this.g.get("T"),e.transform.position.clone().add(b.qa).N(e.transform.matrix().ka(k)).normalize());c.uniform3fv(this.g.get("R"),e.transform.position.clone().normalize());this.Aa();c.activeTexture(c.TEXTURE3);c.bindTexture(c.TEXTURE_2D,e.P);c.uniformMatrix4fv(this.g.get("i"),!1,e.O);c.uniform3fv(this.g.get("Q"),b.V)}else c.activeTexture(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,null),c.uniformMatrix4fv(e.pa,!1,d);c.drawElements(c.TRIANGLES,this.I,c.UNSIGNED_INT,0);c.bindVertexArray(null)}}
let Ta=null;class wb extends Ca{constructor(a){super(D(1,1,.01),0);null===Ta&&(Ta=ea("#version 300 es\nlayout (location = 0)\nin vec3 aVertexPosition;\nout vec2 uv;\nuniform mat4 viewProjectionMatrix;\nuniform mat4 worldMat;\nvoid main()\n{\n    uv = aVertexPosition.xy + 0.5;\n    gl_Position = viewProjectionMatrix * worldMat * vec4(aVertexPosition, 1);\n}","#version 300 es\nprecision highp float;\nin vec2 uv;\nout vec4 fragColor;\nuniform sampler2D tex;\nvoid main()\n{\n    fragColor = texture(tex, uv);\n    if (fragColor.a < 0.01) discard;\n}",
"viewProjectionMatrix","worldMat","tex"));const {m:b,u:d}=Ta;this.m=b;this.g=d;this.j=a;this.G=2E3;this.T=oa()}A(a){this.j=a}M(a,b,d,e){c.useProgram(0===a?this.m:this.T.m);c.bindVertexArray(this.i);c.enable(c.BLEND);c.blendFunc(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA);this.j&&(c.activeTexture(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,this.j));0===a?(c.uniform1i(this.g.get("tex"),0),c.uniformMatrix4fv(this.g.get("viewProjectionMatrix"),!1,b.Y),c.uniformMatrix4fv(this.g.get("worldMat"),!1,d)):(c.uniform1i(this.T.u.get("tex"),
0),c.uniformMatrix4fv(e.pa,!1,d));c.drawElements(c.TRIANGLES,this.I,c.UNSIGNED_INT,0);c.bindVertexArray(null);c.disable(c.BLEND)}}let Ua=null;class eb extends Ca{constructor(a){super(a,0);this.j=0;null===Ua&&(Ua=ea("#version 300 es\nlayout(location=0)in vec4 e;out vec2 o;out vec4 v;uniform mat4 c,t,i;void main(){o=e.xy,o.y+=e.z,v=i*t*e*.5+.5,gl_Position=c*t*e;}","#version 300 es\nprecision highp float;precision highp sampler2DShadow;uniform float n;uniform sampler2DShadow a;uniform bool r;in vec2 o;in vec4 v;out vec4 m;\n\nfloat hash1(float n)\n{\nreturn fract(sin(n) * 43758.5453);\n}\nvec2 hash2(vec2 p)\n{\np = vec2(dot(p, vec2(127.1, 311.7)), dot(p, vec2(269.5, 183.3)));\nreturn fract(sin(p)*43758.5453);\n}\nfloat saturate(float x)\n{\nreturn clamp(x, 0.0, 1.0);\n}\nfloat unlerp(float a, float b, float x)\n{\nreturn (x - a) / (b - a);\n}\nfloat remap(float from0, float from1, float to0, float to1, float x)\n{\nreturn mix(to0, to1, unlerp(from0, from1, x));\n}\nfloat sharpstep(float edge0, float edge1, float x)\n{\nreturn saturate(unlerp(edge0, edge1, x));\n}\nvec4 colorRamp2(vec4 colorA, float posA, vec4 colorB, float posB, float t)\n{\nreturn mix(colorA, colorB, sharpstep(posA, posB, t));\n}\nfloat valueRamp2(float colorA, float posA, float colorB, float posB, float t)\n{\nreturn mix(colorA, colorB, sharpstep(posA, posB, t));\n}\n\n\nvec2 grad(ivec2 z)\n{\nint n=z.x+z.y*11111;\nn=(n<<13)^n;\nn=(n*(n*n*15731+789221)+1376312589)>>16;\nreturn vec2(cos(float(n)),sin(float(n)));\n}\nfloat noise(vec2 p)\n{\nivec2 i=ivec2(floor(p));\nvec2 f=fract(p);\nvec2 u=f*f*(3.-2.*f);\nivec2 oi=ivec2(0,1);\nvec2 of=vec2(oi);\nreturn mix(mix(dot(grad(i+oi.xx),f-of.xx),\ndot(grad(i+oi.yx),f-of.yx),u.x),\nmix(dot(grad(i+oi.xy),f-of.xy),\ndot(grad(i+oi.yy),f-of.yy),u.x),u.y)*.5+.5;\n}\nfloat fbm(vec2 p, int no, float sc, float la)\n{\nfloat t=0.,z=1.;\nfor(int i=0;i<no;++i)\n{\nz*=.5;\nt+=z*noise(p*sc);\np*=la;\n}\nreturn t/(1.-z);\n}\n\nvec3 l(vec3 k,vec2 A,float j,float aa,float ab,float ac,float ad){vec3 ae=vec3(.1+abs(sin(n))*.03,.02,.02);A*=j;float af=1.;vec2 ag=floor(A),ah=fract(A);float ai=noise(A)*ad;for(int aj=-1;aj<=1;++aj)for(int ak=-1;ak<=1;++ak){vec2 al=vec2(aj,ak),am=hash2(ag+al)+ai;am=.5+.5*sin(n*.35+6.2831*am);af=min(af,length(al+am-ah));}float an=noise(A*.1+n*.2*ac)-.8;an*=6.;vec3 ao=vec3(k*pow(af,aa+an*.95)*ab);ao=mix(ae,ao,af);return ao;}void main(){vec2 A=o*.1;m=vec4(0,0,0,1);m.xyz+=l(vec3(1.5,.4,0),A,3.,2.5,1.15,.5,.5);m.xyz+=l(vec3(1.5,0,0),A,6.,3.,.4,.3,0.);m.xyz+=l(vec3(1.2,.4,0),A,8.,4.,.2,.6,.5);if(r)m=m.yxzx;else{float ap=0.;vec3 aq=v.xyz/v.w;vec2 ar=abs(vec2(.5)-aq.xy);if(aq.z>1.||ar.x>.5||ar.y>.5)ap=1.;else ap=texture(a,aq)*.5+.5;m.xyz=min(m.xyz,vec3(1))*ap;}}",
"c","t","n","i","a","r"));const {m:b,u:d}=Ua;this.m=b;this.g=d;this.G=500}M(a,b,d,e){0===a&&(c.useProgram(this.m),c.bindVertexArray(this.i),c.uniformMatrix4fv(this.g.get("c"),!1,b.Y),c.uniformMatrix4fv(this.g.get("t"),!1,d),c.uniform1f(this.g.get("n"),performance.now()/1E3),c.uniform1i(this.g.get("a"),0),c.activeTexture(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,e.P),c.uniformMatrix4fv(this.g.get("i"),!1,e.O),c.uniform1i(this.g.get("r"),this.j),this.j&&(c.enable(c.BLEND),c.blendFunc(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA)),
c.drawElements(c.TRIANGLES,this.I,c.UNSIGNED_INT,0),c.bindVertexArray(null),this.j&&c.disable(c.BLEND))}}const pa=document.createElement("canvas"),tb=pa.getContext("2d");document.getElementsByTagName("style")[0].innerHTML="body{background:#000;color:#fff;user-select:none;font-family:Verdana,sans-serif}.fullscreen{position:absolute;top:0;left:0;width:100vw;height:100vh;pointer-events:none;display:flex;flex-direction:column;align-items:center;z-index:9}#overlay{background-color:#0000;transition:background-color .5s linear;justify-content:space-evenly;font-size:6vh;white-space:pre-line}#overlay.lava{background-color:#a30}#overlay.dead,#powerup-container{background-color:#000}#overlay.respawn{background-color:#0f0}#death-text,#inner{opacity:0;transition:.3s linear;text-align:center}.visible{opacity:1!important}#powerup-container{position:relative;width:35vw;height:5vh;margin-bottom:5vh;border:.5vh solid #000;border-radius:1.3vh;opacity:0;transition:.2s linear}#powerup-bar{width:100%;height:100%;background-image:linear-gradient(#3d0,#170);border-radius:1vh}#powerup-text{position:absolute;top:50%;left:50%;font-size:3vh;transform:translate(-50%,-50%);white-space:nowrap;text-shadow:0 0 1vh #000}";
document.getElementById("main").innerHTML="<div class=fullscreen style=justify-content:flex-end><div id=powerup-container><div id=powerup-bar></div><div id=powerup-text></div></div></div><div id=overlay class=fullscreen><div id=death-text></div><div id=inner></div></div>";const Q=new Hb;Q.add(new Ib);const Cb=new q(0,1,0),Y=function(a,b,d,e=5,k=.5,h=1,f=[.3,.22,.07],m=.5){var n=x=>`
vec4 getColor(vec2 uv)
{
    vec2 coord = uv * float(${e});
    vec2 noise = vec2(fbm(coord, 5, 1.0, 2.0), fbm(coord + vec2(1.23, 4.56), 5, 1.0, 2.0));
    float voro = sqrt(voronoi(noise * 10.0, 1.0).y) * 1.5;

    ${x?`
        vec4 albedo = colorRamp2(vec4(0.95, 0.95, 0.95, 1), 0.2, vec4(1.0, 1.0, 1.0, 1), 0.8, mix(voro, noise.x, 0.5)) * vec4(${f.join(",")}, 1);
        return albedo;
        `:`
        return vec4(vec3(remap(0.0, 1.0, float(${k}), float(${h}), saturate(valueRamp2(0.4, 0.3, 0.6, 0.7, voro)) * 0.2 - noise.x * 1.0)), 1);
        `}
}`;const p=a.Z(b,d);a.$(["\nfloat hash1(float n)\n{\nreturn fract(sin(n) * 43758.5453);\n}\nvec2 hash2(vec2 p)\n{\np = vec2(dot(p, vec2(127.1, 311.7)), dot(p, vec2(269.5, 183.3)));\nreturn fract(sin(p)*43758.5453);\n}\nfloat saturate(float x)\n{\nreturn clamp(x, 0.0, 1.0);\n}\nfloat unlerp(float a, float b, float x)\n{\nreturn (x - a) / (b - a);\n}\nfloat remap(float from0, float from1, float to0, float to1, float x)\n{\nreturn mix(to0, to1, unlerp(from0, from1, x));\n}\nfloat sharpstep(float edge0, float edge1, float x)\n{\nreturn saturate(unlerp(edge0, edge1, x));\n}\nvec4 colorRamp2(vec4 colorA, float posA, vec4 colorB, float posB, float t)\n{\nreturn mix(colorA, colorB, sharpstep(posA, posB, t));\n}\nfloat valueRamp2(float colorA, float posA, float colorB, float posB, float t)\n{\nreturn mix(colorA, colorB, sharpstep(posA, posB, t));\n}\n",
"\nvec2 grad(ivec2 z)\n{\nint n=z.x+z.y*11111;\nn=(n<<13)^n;\nn=(n*(n*n*15731+789221)+1376312589)>>16;\nreturn vec2(cos(float(n)),sin(float(n)));\n}\nfloat noise(vec2 p)\n{\nivec2 i=ivec2(floor(p));\nvec2 f=fract(p);\nvec2 u=f*f*(3.-2.*f);\nivec2 oi=ivec2(0,1);\nvec2 of=vec2(oi);\nreturn mix(mix(dot(grad(i+oi.xx),f-of.xx),\ndot(grad(i+oi.yx),f-of.yx),u.x),\nmix(dot(grad(i+oi.xy),f-of.xy),\ndot(grad(i+oi.yy),f-of.yy),u.x),u.y)*.5+.5;\n}\nfloat fbm(vec2 p, int no, float sc, float la)\n{\nfloat t=0.,z=1.;\nfor(int i=0;i<no;++i)\n{\nz*=.5;\nt+=z*noise(p*sc);\np*=la;\n}\nreturn t/(1.-z);\n}\n",
"\nvec2 voronoi(vec2 x, float w)\n{\nvec2 n=floor(x),f=fract(x),m=vec2(0,8);\nfor (int j=-2;j<3;++j)\nfor (int i=-2;i<3;++i)\n{\nvec2 g=vec2(i,j),o=hash2(n+g);\nfloat d=length(g-f+o),col=.5+.5*sin(hash1(dot(n+g,vec2(7,113)))*2.5+5.),h=smoothstep(0.,1.,.5+.5*(m.y-d)/w);\nm.y=mix(m.y,d,h)-h*(1.-h)*w/(1.+3.*w);\nm.x=mix(m.x,col,h)-h*(1.-h)*w/(1.+3.*w);\n}\nreturn m;\n}\n",n(!0),lb("getColor")],"\n    outColor = edgeBlend(vPixelCoord);\n    ",b,d,[],p);const r=a.Z(b,d);a.$(["\nfloat hash1(float n)\n{\nreturn fract(sin(n) * 43758.5453);\n}\nvec2 hash2(vec2 p)\n{\np = vec2(dot(p, vec2(127.1, 311.7)), dot(p, vec2(269.5, 183.3)));\nreturn fract(sin(p)*43758.5453);\n}\nfloat saturate(float x)\n{\nreturn clamp(x, 0.0, 1.0);\n}\nfloat unlerp(float a, float b, float x)\n{\nreturn (x - a) / (b - a);\n}\nfloat remap(float from0, float from1, float to0, float to1, float x)\n{\nreturn mix(to0, to1, unlerp(from0, from1, x));\n}\nfloat sharpstep(float edge0, float edge1, float x)\n{\nreturn saturate(unlerp(edge0, edge1, x));\n}\nvec4 colorRamp2(vec4 colorA, float posA, vec4 colorB, float posB, float t)\n{\nreturn mix(colorA, colorB, sharpstep(posA, posB, t));\n}\nfloat valueRamp2(float colorA, float posA, float colorB, float posB, float t)\n{\nreturn mix(colorA, colorB, sharpstep(posA, posB, t));\n}\n",
"\nvec2 grad(ivec2 z)\n{\nint n=z.x+z.y*11111;\nn=(n<<13)^n;\nn=(n*(n*n*15731+789221)+1376312589)>>16;\nreturn vec2(cos(float(n)),sin(float(n)));\n}\nfloat noise(vec2 p)\n{\nivec2 i=ivec2(floor(p));\nvec2 f=fract(p);\nvec2 u=f*f*(3.-2.*f);\nivec2 oi=ivec2(0,1);\nvec2 of=vec2(oi);\nreturn mix(mix(dot(grad(i+oi.xx),f-of.xx),\ndot(grad(i+oi.yx),f-of.yx),u.x),\nmix(dot(grad(i+oi.xy),f-of.xy),\ndot(grad(i+oi.yy),f-of.yy),u.x),u.y)*.5+.5;\n}\nfloat fbm(vec2 p, int no, float sc, float la)\n{\nfloat t=0.,z=1.;\nfor(int i=0;i<no;++i)\n{\nz*=.5;\nt+=z*noise(p*sc);\np*=la;\n}\nreturn t/(1.-z);\n}\n",
"\nvec2 voronoi(vec2 x, float w)\n{\nvec2 n=floor(x),f=fract(x),m=vec2(0,8);\nfor (int j=-2;j<3;++j)\nfor (int i=-2;i<3;++i)\n{\nvec2 g=vec2(i,j),o=hash2(n+g);\nfloat d=length(g-f+o),col=.5+.5*sin(hash1(dot(n+g,vec2(7,113)))*2.5+5.),h=smoothstep(0.,1.,.5+.5*(m.y-d)/w);\nm.y=mix(m.y,d,h)-h*(1.-h)*w/(1.+3.*w);\nm.x=mix(m.x,col,h)-h*(1.-h)*w/(1.+3.*w);\n}\nreturn m;\n}\n",n(!1),lb("getColor")],"\n    outColor = edgeBlend(vPixelCoord);\n    ",b,d,[],r);n=a.Z(b,d);a.$([],ob(m),b,d,[r],n);return{ea:p,J:r,
ia:n}}(function(a=document.createElement("canvas")){function b(f,m){f=c.createShader(f);c.shaderSource(f,m);c.compileShader(f);return f}const d=b(c.VERTEX_SHADER,"#version 300 es\nlayout (location = 0)\nin vec2 vp;\nuniform float uAspect;\nout vec2 vPixelCoord;\nvoid main()\n{\nvPixelCoord = (vp+vec2(1))*.5;\ngl_Position=vec4(vp,0,1);\n}"),e=c.createBuffer(),k=new Float32Array([-1,-1,1,-1,-1,1,1,1]);c.bindBuffer(c.ARRAY_BUFFER,e);c.bufferData(c.ARRAY_BUFFER,k,c.STATIC_DRAW);const h=c.createFramebuffer();
return{$:function(f,m,n,p,r,x){a.width=n;a.height=p;c.viewport(0,0,n,p);f=`#version 300 es
precision highp float;
in vec2 vPixelCoord;
out vec4 outColor;

uniform float uAspect;
const vec2 ps = vec2(${1/n}, ${1/p});

${r.map((B,na)=>`uniform sampler2D t${na};`).join("\n")}

${f.join("\n")}

void main()
{
${m}
}`;const u=c.createProgram();f=b(c.FRAGMENT_SHADER,f);c.attachShader(u,d);c.attachShader(u,f);c.linkProgram(u);c.useProgram(u);c.uniform1f(c.getUniformLocation(u,"uAspect"),n/p);r.forEach((B,na)=>{c.activeTexture(c.TEXTURE0+na);c.bindTexture(c.TEXTURE_2D,B);c.uniform1i(c.getUniformLocation(u,"t"+na),na)});c.bindFramebuffer(c.FRAMEBUFFER,h);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,x,0);c.bindBuffer(c.ARRAY_BUFFER,e);c.enableVertexAttribArray(0);c.vertexAttribPointer(0,
2,c.FLOAT,!1,0,0);c.drawArrays(c.TRIANGLE_STRIP,0,k.length/2);c.deleteShader(f);c.deleteProgram(u);c.bindFramebuffer(c.FRAMEBUFFER,null);c.bindTexture(c.TEXTURE_2D,x);c.generateMipmap(c.TEXTURE_2D);c.bindTexture(c.TEXTURE_2D,null)},Z:function(f,m){const n=c.createTexture();c.bindTexture(c.TEXTURE_2D,n);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.REPEAT);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.REPEAT);c.texImage2D(c.TEXTURE_2D,0,c.RGB10_A2,f,m,0,c.RGBA,c.UNSIGNED_INT_2_10_10_10_REV,null);
c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR_MIPMAP_LINEAR);W&&c.texParameterf(c.TEXTURE_2D,W.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(16,c.getParameter(W.MAX_TEXTURE_MAX_ANISOTROPY_EXT)));return n},canvas:a}}(F),2048,2048,15,.5,1,[1,1,1]);class qa extends db{constructor(a,b){super(new q,new fa,a);this.g=new E(D(...a),b);this.add(this.g)}}class ub extends cb{constructor(a,b){super(new q,a);this.g=new E(pb(a,72,48),b);this.add(this.g)}}class ha{constructor(a,b){this.g=!0;this.i=a;this.ra=
()=>{if(this.g){var d=a.ba(w.transform.position,.4);d&&b(this,d)}}}ma(a){this.g=a;this.i.visible=a}}const l={...X("D65647"),C:new q(.2,.2,.2)},ca={...X("388DCC"),C:new q(.2,.2,.2)},H={...X("ADE617"),C:new q(.2,.2,.2)},V={...X("2C5599"),C:new q(.2,.2,.2)},nb={...X("E62000"),C:new q(.2,.2,.2)},Va={...X("1764E6"),C:new q(.2,.2,.2),J:.18};new q(.4,.4,.4);let y=[],ra=[],O=[];const da=await bb(256,256,"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24px' height='24px' viewBox='0 0 24 24' stroke-width='1' stroke='red' fill='none' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='9'/%3E%3Cpath fill='%230f0' d='M16 18h-5l-2-6h2L9 6l6 7h-2z'/%3E%3C/svg%3E"),
Wa=await bb(256,256,"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24px' height='24px' viewBox='0 0 24 24' stroke-width='1' stroke='red' fill='none' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='9'/%3E%3Cpath d='M8 13l4 4m4-4l-4 4M8 8l4 4m4-4l-4 4' stroke='%230f0'/%3E%3C/svg%3E"),M=new q;let N=0;const L=new q,za=[function(){M.h(0,30,0);N=0;L.h(1,3,-3);g(10,10,10,0,0,-2,0,0,0,0,l);g(3,10,3,0,0,-10,0,0,0,0,l);g(3,10,3,4,0,-14,0,1,0,Math.PI/4,l);
t(g(3,20,3,8,0,-16,0,0,0,0,H),-5,0,1);g(11,1,3,17,11,-16,0,0,1,.2,l);g(2,20,1,17,1,-16,0,0,0,0,l);S(5,28,2,-16,l);S(5,28,9,-16,ca);g(10,10,10,41,2,-15,0,0,0,0,l);g(2,10,2,44,0,-6,0,0,0,0,l);g(2,10,2,44,0,-1,0,1,0,Math.PI/4,l);g(2,10,2,47,0,3,0,1,0,Math.PI/4,l);g(2,10,2,41,0,3,0,1,0,Math.PI/4,l);g(12,10,10,44,1,9,0,0,0,0,l);P(44,6,10,0)},function(){M.h(0,30,0);N=0;L.h(1,3,-3);g(10,10,10,0,0,-2,0,0,0,0,l);sa(g(10,1,10,0,5,-14,0,0,0,0,V),.5,1,0,.8,-1);sa(g(10,1,10,0,15,-14,0,0,0,0,V),.5,1,0,.8,-1);g(.5,
32,.5,-5.25,0,-14,0,0,0,0,l);g(.5,32,.5,5.25,0,-14,0,0,0,0,l);sa(g(10,1,10,0,10,-24,0,0,0,0,V),.5,1,0,.8,-1);g(.5,22,.5,-5.25,0,-24,0,0,0,0,l);g(.5,22,.5,5.25,0,-24,0,0,0,0,l);g(5,35,5,10,0,-8,0,0,0,0,l);g(2,20,5,23,0,-8,0,0,1,.6,l);g(2,20,5,26,0,-8,0,0,1,.9,l);g(2,20,5,30,0,-8,0,0,1,1.2,l);g(20,3,5,35,0,-8,0,0,0,0,l);Fa(3,1,3,43,1.2,-8,Va);var a=g(8,1,4,53,5,-8,0,0,0,0,V);const b=new E(D(8.01,1.01,.3),{r:0,H:1,b:0,a:1}),d=new E(D(8.01,1.01,.3),{r:0,H:1,b:0,a:1});a.object.add(b);a.object.add(d);b.transform.position.z=
-2.01+.15;d.transform.position.z=2.01-.15;sa(a,.5,2,0,.2);g(10,20,30,60,0,-28,0,0,0,0,l);g(.5,.5,10,57.25,5,-13,0,0,0,0,l);g(6,5,10.1,58,12.5,-28,0,0,0,0,l);for(a=0;5>a;++a)t(g(4.5,4,2,0,12,2*a-32,0,0,0,0,nb),59,63,2,.5*a,0);P(60,10,-40,0)},function(){M.h(0,30,0);N=0;L.h(1,3,-3);g(10,10,10,0,0,-2,0,0,0,0,l);t(g(5,10,2,0,0,-5.9,0,0,0,0,H),.01,5,3);g(4,20,11,0,0,-18,0,0,0,0,l);ja(10,5,0,11,-18);ja(10,5,0,11,-20,2,-1);ja(10,5,0,11,-22,2,-2);S(1.2,0,8,-27,ca);S(1.2,0,8,-31,ca);S(1.2,0,8,-35,ca);g(1,15,
1,0,0,-27,0,0,0,0,l);g(1,15,1,0,0,-31,0,0,0,0,l);g(1,15,1,0,0,-35,0,0,0,0,l);g(12,10,20,0,0,-50,0,0,0,0,l);for(var a=0;10>a;++a)t(I(3,0,5,-50-a,0),-5,5,3,-a/2,0);g(10,1,10,-5,3,-68,0,0,1,-.4,l);g(10,5,20,0,-1.5,-80,1,0,0,.2,l);g(11,5,20,0,1,-102,0,0,0,0,l);for(a=0;27>a;++a)ja(1,10,.4*a-5.2,4.5,-97,2,a/3);P(0,3.5,-108,0)},function(){M.h(0,30,0);N=0;L.h(-3,3,-1);g(10,10,20,0,0,-5,0,0,0,0,l);J(0,6,-10,Wa,Ia);g(10,15,10,0,5,-25,0,0,0,0,l);const a=Math.PI/2;for(let d=0;7>=d;++d){var b=a*d/7;const e=20*
-Math.sin(a-b);b=20*-Math.cos(a-b);S(1.5,20+e,8+d,-35+b,ca);g(1,15+d,1,20+e,.5*d,-35+b,0,0,0,0,l)}t(g(1,30,1,25,0,-55,0,0,0,0,H),0,10,1);g(10,50,10,32,0,-50,0,0,0,0,l);g(30,40,5,55,0,-50,0,0,0,0,l);J(45,21,-50,da,Z);J(65,21,-50,da,Z);g(10,35,5,85,0,-50,0,0,0,0,l);J(85,18.5,-50,da,Z);g(10,30,10,100,0,-40,0,1,0,Math.PI/4,l);g(5,25,10,100,0,-20,0,0,0,0,l);J(100,13.5,-20,da,Z);g(5,30,1,100,15,-14,1,0,0,.6,l);g(10,25,30,100,0,35,0,0,0,0,l);P(100,12.5,48,0)},function(){M.h(0,30,0);N=0;L.h(1,3,-3);g(10,
10,20,0,0,-5,0,0,0,0,l);g(40,10,10,0,0,-60,0,0,0,0,l);g(20,10,11,0,0,-102,0,0,0,0,l);const a=(n,p,r,x,u=!0,B=0)=>{u&&S(x,n,p,r,ca);g(1,15,1,n,p-7.5,r,0,1,0,B,l)};let b=-20,d=20,e=2,k=-55,h=-18,f=Xa(4);for(var m=0;40>m;++m)a(C(b,d,f()),C(e,5,f()),C(k,h,f()),C(1.2,1.8,f()));b=-10;d=10;h=-65;k=-95;e=3;f=Xa(6);for(m=0;40>m;++m)a(C(b,d,f()),C(e,5,f()),C(k,h,f()),1,!1,f()*Math.PI);P(0,5,-105,0)},function(){M.h(0,30,0);N=0;L.h(1,3,3);g(10,5,30,0,0,-10,0,0,0,0,l);g(10,1,10,0,7,-20,0,0,0,0,V).o.push(a=>a.transform.rotation.s(0,
0,1,z));g(10,1,10,8,14,-20,0,0,0,0,V).o.push(a=>a.transform.rotation.s(0,0,1,-z+Math.PI/2));g(10,1,10,0,21,-20,0,0,0,0,V).o.push(a=>a.transform.rotation.s(0,0,1,z));g(.5,50,.5,0,0,-25.25,0,0,0,0,l);g(.5,50,.5,0,0,-14.75,0,0,0,0,l);g(.5,30,.5,8,0,-25.25,0,0,0,0,l);g(.5,30,.5,8,0,-14.75,0,0,0,0,l);g(10,1,10,-10,25,-20,0,0,0,0,l);g(1,50,1,-10,0,-20,0,0,0,0,l);g(40,50,10,-36,0,-20,0,0,0,0,l);t(g(10,10,10,-26,30,0,0,0,0,0,nb),-24,-16,1.2,0,2);t(g(2,10,5,-50,0,-20,0,0,0,0,H),20.01,30,3);g(1,90,10,-60,0,
-20,0,0,0,0,l);g(1,70,10,-70,0,-20,0,0,0,0,l);for(let a=0;10>a;++a)I(3,-60,45,-24.5+a,0),I(3,-70,35,-24.5+a,0);g(2,60,10,-65,0,-20,0,0,0,0,l);Fa(1.99,.5,9.99,-65,30,-20,Va);g(20,50,10,-85,0,-20,0,0,0,0,l);P(-94,25,-20,Math.PI/2)},function(){M.h(0,30,0);N=0;L.h(-3,3,-1);g(10,5,35,0,0,-15,0,0,0,0,l);for(let a=0;10>a;++a)t(I(1.5,a-4.5,2.5,0,Math.PI/-2),-25,-15,3,a,2);g(10,2,20,0,-1,-45,1,0,0,.2,l);J(0,2,-52,Wa,Ia);g(5,20,5,0,0,-60,0,0,0,0,l);g(5,35,5,0,0,-72,0,0,0,0,l);g(5,50,5,10,0,-72,0,0,0,0,l);g(10,
40,5,20,0,-72,0,0,0,0,l);J(20,21,-72,da,Z);g(5,35,5,37,0,-65,0,1,0,-.3,l);g(5,30,5,45,0,-50,0,1,0,1,l);g(5,25,5,55,0,-40,0,0,0,0,l);g(5,20,5,55,0,-25,0,0,0,0,l);Fa(4.99,.5,4.99,55,10,-25,Va);g(10,20,5,55,0,-12,0,0,0,0,l);P(55,10,-10,0)},function(){M.h(0,30,-2);N=Math.PI;L.h(3,3,-1);g(10,5,20,0,0,5,0,0,0,0,l);t(g(5,10,2,0,0,10,0,0,0,0,H),-2.49,7,4);g(1,50,10,-5.5,0,10,0,0,0,0,l);g(1,50,10,5.5,0,10,0,0,0,0,l);g(12,50,1,0,0,15.5,0,0,0,0,l);g(12,15,1,0,17.5,4.5,0,0,0,0,l);for(var a=0;10>a;++a)t(I(3,4.5-
a,20,0,Math.PI/2),6,14,3.23,0,2);t(g(10,.3,.3,0,20,0,0,0,0,0,H),6,14,3.23,0,2);g(10,40,10,0,0,20,0,0,0,0,l);g(1,80,10,-5.5,0,35,0,0,0,0,l);g(1,80,10,5.5,0,35,0,0,0,0,l);g(12,55,1,0,0,29.5,0,0,0,0,l);g(12,31,1,0,24.5,40.5,0,0,0,0,l);g(10,5,80,0,0,70,0,0,0,0,l);J(0,21,24,Wa,Ia);t(g(10,.3,.3,0,25,0,0,0,0,0,H),31,39,3.23,0,2);t(g(.3,.3,10,0,20,35,0,0,0,0,H),-4,4,3.23,1,0);t(g(10,.3,.3,0,15,0,0,0,0,0,H),31,39,3.23,2,2);t(g(.3,.3,10,0,10,35,0,0,0,0,H),-4,4,3.23,3,0);for(a=0;10>a;++a)t(I(3,4.5-a,25,0,Math.PI/
2),31,39,3.23,0,2),t(I(3,0,20,39.5-a,0),-4,4,3.23,1,0),t(I(3,4.5-a,15,0,Math.PI/2),31,39,3.23,2,2),t(I(3,0,10,39.5-a,0),-4,4,3.23,3,0);J(0,3.5,45,da,Z);for(a=0;100>a;++a)ja(25,1,0,3.5,50+.4*a,10,-a/3);P(0,2.5,108,0)}];let ba=0;const wa=new eb(D(1E3,1,1E3));wa.transform.position.y=-1;Q.add(wa);const w=new E({l:new Float32Array,F:new Uint32Array,v:new Float32Array},l);Q.add(w);const ka=new mb;ka.transform.position.y=1.5;w.add(ka);hb();window.addEventListener("resize",hb);let Ma=0,La=0,Na=0,Oa=0,Pa=
0;window.addEventListener("keydown",a=>{switch(a.code){case "KeyW":Na=1;break;case "KeyA":Ma=1;break;case "KeyS":Oa=1;break;case "KeyD":La=1;break;case "Space":Pa=1}});window.addEventListener("keyup",a=>{switch(a.code){case "KeyW":Na=0;break;case "KeyA":Ma=0;break;case "KeyS":Oa=0;break;case "KeyD":La=0;break;case "Space":Pa=0}});let Qa=null;F.addEventListener("click",()=>{F.requestPointerLock()});document.addEventListener("pointerlockchange",()=>{Qa=document.pointerLockElement});let ta=0,Ga=0;window.addEventListener("mousemove",
a=>{if(Qa){var b=a.movementY;Ga-=.002*a.movementX;ta=Da(ta-.002*b,-Math.PI/2,Math.PI/2);ib()}});const K=1/60.001,v=new q;let la=!1,ua=0,G=0;const va=document.getElementById("powerup-container"),Ab=document.getElementById("powerup-bar"),Bb=document.getElementById("powerup-text");let Ha="",Ka=0,xa=!0,kb=0,ma=0,z=0;const Db=5*K;requestAnimationFrame(jb);const T=document.getElementById("overlay"),aa=document.getElementById("death-text"),A=document.getElementById("inner");let ya=!0;fb(za[ba]);document.body.appendChild(F)})();
